\documentclass{ctexart}
\usepackage{anyfontsize}
\usepackage{hyperref}
\usepackage{graphicx}
\usepackage{amsmath,amsthm}

\author{夏海淞}
\title{线性代数习题答案}
\date{\today}

\ctexset { section = { name={第,章} } }
\ctexset { section = { number={\chinese {section}} } }

\newtheorem{problem}{习题}[section]
\newtheorem{extraprob}{附加习题}[section]
\newtheorem{suplprob}{补充习题}[section]

\renewcommand{\labelenumi}{(\theenumi)}
\renewcommand{\proofname}{解}

\input{headers.tex}

\begin{document}
\maketitle
\tableofcontents

\clearpage
\section{矩阵}

% 1.1
\begin{problem}
计算下列矩阵的乘积：

\begin{enumerate}
    \item[(1)] \(\begin{bmatrix}
            4 & 3 & 1 \\1&-2&3\\5&7&0
        \end{bmatrix}\begin{bmatrix}
            7 \\2\\1
        \end{bmatrix}\)
    \item[(5)] \(\begin{bmatrix}
            x_1 & x_2 & x_3
        \end{bmatrix}
        \begin{bmatrix}
            a_{11} & a_{12} & a_{13} \\
            a_{12} & a_{22} & a_{23} \\
            a_{13} & a_{23} & a_{33}
        \end{bmatrix}
        \begin{bmatrix}
            x_1 \\x_2\\x_3
        \end{bmatrix}\)
\end{enumerate}
\end{problem}
\begin{proof}
    \begin{enumerate}
        \item[(1)] \(\begin{bmatrix}
                4 & 3 & 1 \\1&-2&3\\5&7&0
            \end{bmatrix}\begin{bmatrix}
                7 \\2\\1
            \end{bmatrix}=\begin{bmatrix}
                35 \\6\\49
            \end{bmatrix}\)
        \item[(5)]
            \begin{align*}
                  & \begin{bmatrix}
                        x_1 & x_2 & x_3
                    \end{bmatrix}
                \begin{bmatrix}
                    a_{11} & a_{12} & a_{13} \\
                    a_{12} & a_{22} & a_{23} \\
                    a_{13} & a_{23} & a_{33}
                \end{bmatrix}
                \begin{bmatrix}
                    x_1 \\x_2\\x_3
                \end{bmatrix}                                                                                    \\
                = & \begin{bmatrix}\sum_{i=1}^3a_{1i}x_i+\sum_{i=1}^3a_{2i}x_i+\sum_{i=1}^3a_{3i}x_i\end{bmatrix}
                \begin{bmatrix}x_1 \\x_2 \\x_3\end{bmatrix}                                                       \\
                = & \sum_{1 \leq i<j \leq 3} 2 a_{i j} x_i x_j+\sum_{k=1}^3 a_{k k} x_k^2
            \end{align*}

    \end{enumerate}
\end{proof}

% 1.2
\begin{problem}
设\(\mata=\begin{bmatrix}
    1 & 1  & 1  \\
    1 & 1  & -1 \\
    1 & -1 & 1
\end{bmatrix}\)，\(\matb=\begin{bmatrix}
    1  & 2  & 3 \\
    -1 & -2 & 4 \\
    0  & 5  & 1
\end{bmatrix}\)，求\(3\mata\matb-2\mata\)。
\end{problem}
\begin{proof}
    \begin{align*}
         & \mata\matb           =
        \left[\begin{array}{ccc}
                      1 & 1  & 1  \\
                      1 & 1  & -1 \\
                      1 & -1 & 1
                  \end{array}\right]
        \left[\begin{array}{ccc}
                      1  & 2  & 3 \\
                      -1 & -2 & 4 \\
                      0  & 5  & 1
                  \end{array}\right]=
        \left[\begin{array}{ccc}
                      0 & 5  & 8 \\
                      0 & -5 & 6 \\
                      2 & 9  & 0
                  \end{array}\right]  \\
         & 3\mata\matb-2 \mata  =
        3\left[\begin{array}{ccc}
                       0 & 5  & 8 \\
                       0 & -5 & 6 \\
                       2 & 9  & 0
                   \end{array}\right]
        -2\left[\begin{array}{ccc}
                        1 & 1  & 1  \\
                        1 & 1  & -1 \\
                        1 & -1 & 1
                    \end{array}\right]
        =\left[\begin{array}{ccc}
                       -2 & 13  & 22 \\
                       -2 & -17 & 20 \\
                       4  & 29  & -2
                   \end{array}\right]
    \end{align*}
\end{proof}

% 1.3
\begin{problem}
设\(\mata=\begin{bmatrix}3&1\\1&-3\end{bmatrix}\)，求\(\mata^{50}\)和\(\mata^{51}\)。
\end{problem}
\begin{proof}
    \begin{equation*}
        \begin{array}{lll}
            \mata^2=\begin{bmatrix}3&1\\1&-3\end{bmatrix}\begin{bmatrix}3&1\\1&-3\end{bmatrix}=\begin{bmatrix}10&0\\0&10\end{bmatrix}      \\
            \mata^{50}=\mypar{\mata^2}^{25}={\begin{bmatrix}10&0\\0&10\end{bmatrix}}^{25}=\begin{bmatrix}10^{25}&0\\0&10^{25}\end{bmatrix} \\
            \mata^{51}=\mata^{50}\mata=\begin{bmatrix}10^{25}&0\\0&10^{25}\end{bmatrix}\begin{bmatrix}3&1\\1&-3\end{bmatrix}=\begin{bmatrix}3\cdot10^{25}&10^{25}\\10^{25}&-3\cdot10^{25}\end{bmatrix}
        \end{array}
    \end{equation*}
\end{proof}

% 1.4
\begin{problem}
\begin{enumerate}
    \item 设\(\mata,\matb\)为\(n\)阶矩阵，且\(\mata\)为对称矩阵，证明\(\matb^\top\mata\matb\)也是对称矩阵；
    \item 设\(\mata,\matb\)为\(n\)阶对称矩阵，证明\(\mata\matb\)是对称矩阵的充要条件是\(\mata\matb=\matb\mata\)。
\end{enumerate}
\end{problem}
\begin{proof}
    \begin{enumerate}
        \item \begin{equation*}
                  \begin{array}{lll}
                      \mata\text{为对称矩阵}\Rightarrow \mata^\top=\mata \\
                      \mypar{\matb^\top\mata\matb}^\top=\matb^\top\mypar{\matb^\top\mata}^\top=
                      \matb^\top\mata^\top\mypar{\matb^\top}^\top=\matb^\top\mata\matb
                  \end{array}
              \end{equation*}
        \item \begin{itemize}
                  \item 充分条件：\begin{equation*}
                            \mata\matb=\matb\mata\Rightarrow\mypar{\mata\matb}^\top=\matb^\top\mata^\top=\matb\mata=\mata\matb
                        \end{equation*}
                  \item 必要条件：\begin{equation*}
                            \mata\matb=\mypar{\mata\matb}^\top\Rightarrow\mata\matb=\mypar{\mata\matb}^\top=\matb^\top\mata^\top=\matb\mata
                        \end{equation*}
              \end{itemize}
    \end{enumerate}
\end{proof}

% 1.5
\begin{problem}
证明矩阵\(\mata=\mato\)的充分必要条件是方阵\(\mata^\top\mata=\mato\)。
\end{problem}
\begin{proof}
    必要性显然成立。下面证明充分性。

    设矩阵\(\mata=\mat{a_{ij}}_{m\times n}\)。由\(\mata^\top\mata=\mato\)和定义1.2.5，有

    \begin{equation*}
        \mat{\mata^\top\mata}_{ii}=\sum_{k=1}^m\mat{\mata^\top}_{ik}\mat{\mata}_{ki}=\sum_{k=1}^ma_{ki}^2=0
    \end{equation*}

    对\(i=1,2,\dots,n\)均成立。因此有\(\mata=\mato\)。
\end{proof}

% 1.6
\begin{problem}
设

\begin{equation*}
    \mata=\begin{bmatrix}a&0&0\\0&b&0\\0&0&c\end{bmatrix},
    \matb=\begin{bmatrix}0&1&0\\0&0&1\\0&0&0\end{bmatrix},
    \matc=\begin{bmatrix}\cos \theta&\sin \theta\\-\sin \theta&\cos \theta\end{bmatrix}
\end{equation*}

求\(\mata^5,\matb^3,\matc^n\)。
\end{problem}
\begin{proof}
    \begin{equation*}
        \mata^5=\begin{bmatrix}a^5&0&0\\0&b^5&0\\0&0&c^5\end{bmatrix},\matb^3=\begin{bmatrix}0&0&0\\0&0&0\\0&0&0\end{bmatrix},\matc^n=\begin{bmatrix}\cos n\theta&\sin n\theta\\-\sin n\theta&\cos n\theta\end{bmatrix}
    \end{equation*}

    数学归纳法格式：

    猜想\(\matc^n=\begin{bmatrix}\cos n\theta&\sin n\theta\\-\sin n\theta&\cos n\theta\end{bmatrix}\)对\(n\in N^+\)成立。

    当\(n=1\)时，\(\matc^n=\begin{bmatrix}\cos \theta&\sin \theta\\-\sin \theta&\cos \theta\end{bmatrix}\)，结论成立。

    设当\(n=k\)时结论成立，则当\(n=k+1\)时，
    \begin{align*}
        \matc^{k+1} & =\matc^k\matc=\begin{bmatrix}\cos k\theta&\sin k\theta\\-\sin k\theta&\cos k\theta\end{bmatrix}\begin{bmatrix}\cos \theta&\sin \theta\\-\sin \theta&\cos \theta\end{bmatrix} \\
                    & =\begin{bmatrix}\cos (k+1)\theta&\sin (k+1)\theta\\-\sin (k+1)\theta&\cos (k+1)\theta\end{bmatrix}
    \end{align*}

    由归纳公理知\(\matc^n=\begin{bmatrix}\cos n\theta&\sin n\theta\\-\sin n\theta&\cos n\theta\end{bmatrix}\)对\(n\in N^+\)成立。
\end{proof}

% 1.7
\begin{problem}
已知\(\begin{bmatrix}a&1&1\\3&0&1\\0&2&-1\end{bmatrix}\begin{bmatrix}3\\a\\-3\end{bmatrix}=\begin{bmatrix}b\\6\\b\end{bmatrix}\)，求\(a\)和\(b\)。
\end{problem}
\begin{proof}
    计算矩阵乘法，由等式可得

    \begin{equation*}
        \begin{cases}
            3a+a-3=b       \\
            9+0\cdot a-3=6 \\
            2a+3=b
        \end{cases}
    \end{equation*}

    解线性方程组得\(a=3,b=9\)。
\end{proof}

% 1.8
\begin{problem}
若\(\mata\)是\(n\)阶方阵且\(\mata^n=\mato\)，试证：

\begin{equation*}
    \mypar{\mati_n-\mata}\mypar{\mati_n+\sum_{i=1}^{n-1}\mata^i}
\end{equation*}
\end{problem}
\begin{proof}
    因为\(\mata^n=\mato\)，我们得到

    \begin{align*}
          & \mypar{\mati_n-\mata}\mypar{\mati_n+\sum_{i=1}^{n-1}\mata^i} \\
        = & \mati_n+\sum_{i=1}^{n-1}\mata^i-\sum_{i=1}^n\mata^i          \\
        = & \mati_n-\mata^n=\mati_n
    \end{align*}
\end{proof}

% 1.9
\begin{problem}
计算下列矩阵的\(n\)次方幂：

\begin{enumerate}
    \item[(3)] 设\(\matc=\begin{bmatrix}1&-1&-1&-1\\-1&1&-1&-1\\-1&-1&1&-1\\-1&-1&-1&1\end{bmatrix}\)，求\(\matc^n\)；
    \item[(4)] 设\(\matd=\begin{bmatrix}1&1&0\\0&1&1\\0&0&1\end{bmatrix}\)，求\(\matd^n\)。
\end{enumerate}
\end{problem}
\begin{proof}
    \begin{enumerate}

        \item[(3)]
            {
            容易发现
            \begin{equation*}
                \matc^2=
                \begin{bmatrix}
                    4 & 0 & 0 & 0 \\
                    0 & 4 & 0 & 0 \\
                    0 & 0 & 4 & 0 \\
                    0 & 0 & 0 & 4
                \end{bmatrix}=4\mati_4
            \end{equation*}
            因此根据奇偶性讨论，有
            \begin{equation*}
                \matc^n=
                \begin{cases}
                    2^{n-1}\matc & n=2k-1 \\
                    2^n\mati_4   & n=2k
                \end{cases}
                (k\in N^+)
            \end{equation*}
            }

        \item[(4)]
            {
            记\(\matd'=\begin{bmatrix}0&1&0\\0&0&1\\0&0&0\end{bmatrix}\)，容易发现
            \begin{equation*}
                \matd'^2=\begin{bmatrix}0&0&1\\0&0&0\\0&0&0\end{bmatrix},\matd'^n=\mato(n\ge3)
            \end{equation*}
            因此有
            \begin{align*}
                \matd^n & =\mypar{\mati+\matd'}^n                 \\
                        & =\mati+\sum_{i=1}^n\binom{n}{i}\matd'^i \\
                        & =\mati+n\matd'+\binom{n}{2}\matd'^2     \\
                        & =\begin{bmatrix}
                               1 & n & n(n-1)/2 \\
                               0 & 1 & n        \\
                               0 & 0 & 1
                           \end{bmatrix}
            \end{align*}
            }
    \end{enumerate}
\end{proof}

% 1.10
\begin{problem}
试证：
\begin{enumerate}
    \item 与所有\(n\)阶对角阵乘法可交换的矩阵也必是\(n\)阶对角阵；
    \item 与所有\(n\)阶矩阵乘法可交换的矩阵是纯量阵。
\end{enumerate}
\end{problem}
\begin{proof}
    \begin{enumerate}
        \item
              {
              设矩阵\(\mata=\mat{a_{ij}}_{n\times n}\)为对角阵，矩阵\(\matb=\mat{b_{ij}}_{n\times n}\)。则有
              \begin{equation*}
                  \begin{array}{lll}
                      \mat{\mata\matb}_{ij}=\sum_{k=1}^na_{ik}b_{kj}=a_{ii}b_{ij} \\
                      \mat{\matb\mata}_{ij}=\sum_{k=1}^nb_{ik}a_{kj}=a_{jj}b_{ij}
                  \end{array}
              \end{equation*}
              由题设可知\(\mat{\mata\matb}_{ij}=\mat{\matb\mata}_{ij}\)对任意\(i,j\in\setof{1,2,\dots,n}\)成立。

              当\(i=j\)时，等式成立；当\(i\neq j\)时，由\(\mata\)的任意性知\(b_{ij}=0\)，即\(\matb\)为对角阵。
              }
        \item
              {
              由(1)知，满足要求的矩阵为对角阵。

              设矩阵\(\mata=\mat{a_{ij}}_{n\times n}\)为对角阵，矩阵\(\matb=\mat{b_{ij}}_{n\times n}\)。

              同(1)理，可得\(a_{ii}b_{ij}=a_{jj}b_{ij}\)对任意\(i,j\in\setof{1,2,\dots,n}\)成立。由\(\matb\)的任意性可知\(a_{ii}=a_{jj}\)对任意\(i,j\in\setof{1,2,\dots,n}\)成立，即\(\mata\)为纯量阵。
              }
    \end{enumerate}
\end{proof}

% 1.11
\begin{problem}
证明：两个对角元为\(1\)的上三角阵乘积仍是对角元为\(1\)的上三角阵。
\end{problem}
\begin{proof}
    设矩阵\(\mata=\mat{a_{ij}}_{n\times n}\)，矩阵\(\matb=\mat{b_{ij}}_{n\times n}\)。则有\(\mat{\mata\matb}_{ij}=\sum_{k=1}^na_{ik}b_{kj}=\sum_{k=1}^{i-1}a_{ik}b_{kj}+a_{ii}b_{ij}+\sum_{t=i+1}^na_{it}b_{tj}\)。

    当\(i>j\)时，因为\(\mata,\matb\)均为上三角矩阵，因此有\(a_{ik}=b_{tj}=0(k<i,t>=i)\)，代入上式可得\(\mat{\mata\matb}_{ij}=0\)；

    当\(i=j\)时，因为\(\mata,\matb\)均为对角元为\(1\)的上三角矩阵，因此有\(a_{ik}=b_{tj}=0(k<i,t>i)\)，代入上式可得\(\mat{\mata\matb}_{ij}=a_{ii}b_{ij}=1\)。

    综上，\(\mata\matb\)为对角元为\(1\)的上三角矩阵。
\end{proof}

% 1.12
\begin{problem}
设\(n\)元向量\(\vecx=\begin{bmatrix}x_1\\x_2\\\vdots\\x_n\end{bmatrix}\)，\(\vecy=\begin{bmatrix}y_1\\y_2\\\vdots\\y_n\end{bmatrix}\)。若\(\mata=\vecy\vecx^\top\)，求\(\mata^k\mypar{k \in N^+}\)。
\end{problem}
\begin{proof}
    \begin{equation*}
        \begin{array}{lll}
            \mata=\vecy\vecx^\top=
            \begin{bmatrix}
                x_1y_1 & x_2y_1 & \cdots & x_ny_1 \\
                x_1y_2 & x_2y_2 & \cdots & x_ny_2 \\
                \vdots & \vdots & \ddots & \vdots \\
                x_1y_n & x_2y_n & \cdots & x_ny_n \\
            \end{bmatrix}  \\
            \vecx^\top\vecy=\sum_{i=1}^nx_iy_i \\
        \end{array}
    \end{equation*}

    因此有
    \begin{align*}
        \mata^k & =\underbrace{\mypar{\vecy\vecx^\top}\mypar{\vecy\vecx^\top}\cdots\mypar{\vecy\vecx^\top}}_k                    \\
                & =\vecy\underbrace{\mypar{\vecx^\top\vecy}\mypar{\vecx^\top\vecy}\cdots\mypar{\vecx^\top\vecy}}_{k-1}\vecx^\top \\
                & =\mypar{\vecx^\top\vecy}^{k-1}\vecy\vecx^\top=\mypar{\sum_{i=1}^nx_iy_i}^{k-1}
        \begin{bmatrix}
            x_1y_1 & x_2y_1 & \cdots & x_ny_1 \\
            x_1y_2 & x_2y_2 & \cdots & x_ny_2 \\
            \vdots & \vdots & \ddots & \vdots \\
            x_1y_n & x_2y_n & \cdots & x_ny_n \\
        \end{bmatrix}
    \end{align*}
\end{proof}

% 1.13
\begin{problem}
设\(n\mypar{n\ge2}\)元向量\(\vecx=\begin{bmatrix}\frac12\\0\\\vdots\\0\\\frac12\end{bmatrix}\)，\(\mata=\mati_n-\vecx\vecx^\top\)，\(\matb=\mati_n+2\vecx\vecx^\top\)，求\(\mata\matb\)。
\end{problem}
\begin{proof}
    \begin{align*}
        \vecx^\top\vecx & =
        \begin{bmatrix}
            \frac{1}{2} & 0 & \cdots & 0 & \frac{1}{2}
        \end{bmatrix}
        \begin{bmatrix}
            \frac{1}{2} & 0 & \cdots & 0 & \frac{1}{2}
        \end{bmatrix}^\top=\frac{1}{2}                                         \\
        \mata\matb      & =\mypar{\mati_n-\vecx\vecx^\top}\mypar{\mati_n+2\vecx\vecx^\top} \\
                        & =\mati_n+\vecx\vecx^\top-2\vecx\mypar{\vecx^\top\vecx}\vecx^\top \\
                        & =\mati_n+\vecx\vecx^\top-\vecx\vecx^\top=\mati_n
    \end{align*}
\end{proof}

% 1.14
\begin{problem}
设\(\mata\)是\(m\times n\)矩阵。证明：若对于任何\(n\)元列向量\(\vecx\)成立\(\mata\vecx=\veczero\)，则\(\mata=\mato_{m\times n}\)。
\end{problem}
\begin{proof}
    设\(\mata=\begin{bmatrix}\veca_1&\veca_2&\cdots&\veca_n\end{bmatrix}\)，\(\vece_i\)表示第\(i\)个分量为\(1\)，其余分量为\(0\)的\(n\)阶列向量。由题设可知

    \begin{equation*}
        \mata\vece_i=\veca_i=\veczero
    \end{equation*}

    对\(i=1,2,\dots,n\)均成立。因此有\(\veca_1=\veca_2=\cdots=\veca_n=\veczero\)，即\(\mata=\mato\)。
\end{proof}

% 1.15
\begin{problem}
设\(n\)阶方阵\(\mata,\matb\)满足\(\mata^2=\mata\)，\(\matb^2=\matb\)，且\(\mypar{\mata+\matb}^2=\mata+\matb\)，证明：\(\mata\matb=\mato\)。
\end{problem}
\begin{proof}
    根据\(\mata^2=\mata,\matb^2=\matb\)，可将\(\mypar{\mata+\matb}^2\)展开：

    \begin{align*}
        \mypar{\mata+\matb}^2 & =\mata^2+\matb^2+\mata\matb+\matb\mata \\
                              & =\mata+\matb+\mata\matb+\matb\mata
    \end{align*}

    又因为\(\mypar{\mata+\matb}^2=\mata+\matb\)，可得

    \begin{equation}\label{eq-1.15}
        \mata\matb+\matb\mata=\mato
    \end{equation}

    将\eqref{eq-1.15}式左乘\(\mata\)，得到\(\mata\matb+\mata\matb\mata=\mato\)；将\eqref{eq-1.15}式式左右各乘\(\mata\)，得到\(2\mata\matb\mata=\mato\)。将上述两式联立解得\(\mata\matb=\mato\)。
\end{proof}

% 1.16
\begin{problem}
设\(\mata=\begin{bmatrix}1&0&1\\0&2&0\\1&0&1\end{bmatrix}\)，求\(\mata^n-2\mata^{n-1}\)。
\end{problem}
\begin{proof}
    因为\(\mata^n-2\mata^{n-1}=\mata^{n-1}(\mata-2\mati)\)，容易发现

    \begin{equation*}
        \mata(\mata-2\mati)=
        \begin{bmatrix}
            1 & 0 & 1 \\0&2&0\\1&0&1
        \end{bmatrix}
        \begin{bmatrix}
            -1 & 0 & 1 \\0&0&0\\1&0&-1
        \end{bmatrix}=\mato
    \end{equation*}

    因此当\(n\ge2\)时，\(\mata^n-2\mata^{n-1}=\mata^{n-2}\mata(\mata-2\mati)=\mato\)。
\end{proof}

% 1.17
\begin{problem}
设\(n\)阶方阵\(\mata,\matb\)满足\(\mata^2=-\mata\)，\(\matb^2=-\matb\)，且\(\mypar{\mata+\matb}^2=-\mata-\matb\)，证明：\(\mata\matb=\mato\)。
\end{problem}
\begin{proof}
    根据\(\mata^2=-\mata,\matb^2=-\matb\)，可将\(\mypar{\mata+\matb}^2\)展开：

    \begin{align*}
        \mypar{\mata+\matb}^2 & =\mata^2+\matb^2+\mata\matb+\matb\mata \\
                              & =-\mata-\matb+\mata\matb+\matb\mata
    \end{align*}

    又因为\(\mypar{\mata+\matb}^2=-\mata-\matb\)，可得

    \begin{equation}\label{eq-1.17}
        \mata\matb+\matb\mata=\mato
    \end{equation}

    将\eqref{eq-1.17}式左乘\(\mata\)，得到\(\mata\matb+\mata\matb\mata=\mato\)；将\eqref{eq-1.17}式左右各乘\(\mata\)，得到\(2\mata\matb\mata=\mato\)。将上述两式联立解得\(\mata\matb=\mato\)。
\end{proof}

\setcounter{problem}{18}
% 1.19
\begin{problem}
设\(\mata=\mati-\vecal\vecal^\top\)，其中\(\vecal\)为非零\(n\times1\)矩阵，试证：\(\mata^2=\mata\)的充要条件是\(\vecal^\top\vecal=1\)。
\end{problem}
\begin{proof}
    \begin{itemize}
        \item 首先证明充分性：
              因为\(\vecal^\top\vecal=1\)，因此有
              \begin{align*}
                  \mata^2 & =\mypar{\mati-\vecal\vecal^\top}^2                                   \\
                          & =\mati-2\vecal\vecal^\top+\vecal\mypar{\vecal^\top\vecal}\vecal^\top \\
                          & =\mati-\vecal\vecal^\top=\mata
              \end{align*}

              充分性得证。

        \item 随后证明必要性：
              因为\(\mata^2=\mata\)，因此有
              \begin{align*}
                  \mata^2-\mata & =\mat{\mati-2\vecal\vecal^\top+\vecal\mypar{\vecal^\top\vecal}\vecal^\top}-\mypar{\mati-\vecal\vecal^\top} \\
                                & =\mypar{\vecal^\top\vecal-1}\vecal\vecal^\top=\mato
              \end{align*}

              因为\(\vecal\neq\veczero\)，因此\(\vecal^\top\vecal-1=0\)，即\(\vecal^\top\vecal=1\)。
    \end{itemize}
\end{proof}

\setcounter{problem}{21}
% 1.22
\begin{problem}
计算下列矩阵的\(k\)次幂，其中\(k\)为正整数：

\begin{enumerate}
    \item \(\mata=\begin{bmatrix}1&a&0\\0&1&a\\0&0&1\end{bmatrix}\)；
    \item \(\mata=\begin{bmatrix}1&2&4\\2&4&8\\3&6&12\end{bmatrix}\)。
\end{enumerate}
\end{problem}
\begin{proof}
    \begin{enumerate}
        \item 记\(\mata'=\begin{bmatrix}0&a&0\\0&0&a\\0&0&0\end{bmatrix}\)，容易发现
              \begin{equation*}
                  \mata'^2=\begin{bmatrix}0&0&a^2\\0&0&0\\0&0&0\end{bmatrix},\mata'^n=\mato(n\ge3)
              \end{equation*}
              因此有
              \begin{align*}
                  \mata^k & =\mypar{\mati+\mata'}^k                 \\
                          & =\mati+\sum_{i=1}^k\binom{k}{i}\mata'^i \\
                          & =\mati+k\mata'+\binom{k}{2}\mata'^2     \\
                          & =\begin{bmatrix}
                                 1 & ka & \frac{k(k-1)}{2}a^2 \\
                                 0 & 1  & ka                  \\
                                 0 & 0  & 1
                             \end{bmatrix}
              \end{align*}
        \item 记\(\vecal=\begin{bmatrix}1\\2\\3\end{bmatrix}\)，\(\vecbeta=\begin{bmatrix}1\\2\\4\end{bmatrix}\)。容易发现\(\mata=\vecal\vecbeta^\top\)，因此有
              \begin{align*}
                  \mata^k & =\mypar{\vecal\vecbeta^\top}^k=\vecal\mypar{\vecbeta^\top\vecal}^{k-1}\vecbeta^\top \\
                          & =\mypar{17}^{k-1}\vecal\vecbeta^\top=\mypar{17}^{k-1}
                  \begin{bmatrix}
                      1 & 2 & 4 \\2&4&8\\3&6&12
                  \end{bmatrix}
              \end{align*}
    \end{enumerate}
\end{proof}

% 1.23
\begin{problem}
设\(\mata,\matb\)是两个\(n\)阶矩阵，若\(\trace{\mata\matb\matc}=\trace{\matc\matb\mata}\)对任意\(n\)阶矩阵\(\matc\)成立，求证\(\mata\matb=\matb\mata\)。
\end{problem}
\begin{proof}
    令\(\matc=\vece_i\vece_j^\top\)，其中\(\vece_i\)表示第\(i\)个分量为\(1\)，其余分量为\(0\)的\(n\)阶列向量。因此有
    \begin{align*}
        \mat{\mata\matb\matc}_{tt} & =\sum_{k=1}^n\mat{\mata\matb}_{tk}\mat{\matc}_{kt}=
        \begin{cases}
            \mat{\mata\matb}_{ji} & t=j     \\
            0                     & t\neq j
        \end{cases}                                                  \\
        \mat{\matc\matb\mata}_{tt} & =\sum_{k=1}^n\mat{\matc}_{tk}\mat{\matb\mata}_{kt}=
        \begin{cases}
            \mat{\matb\mata}_{ji} & t=i     \\
            0                     & t\neq i
        \end{cases}
    \end{align*}

    因为\(\trace{\mata\matb\matc}=\trace{\matc\matb\mata}\)，因此有\(\mat{\mata\matb}_{ji}=\mat{\matb\mata}_{ji}\)对\(i,j\in\setof{1,2,\dots,n}\)成立，即\(\mata\matb=\matb\mata\)。
\end{proof}

% 1.24
\begin{problem}
设

\begin{equation*}
    \mata=\begin{bmatrix}1&0&0&0\\0&1&0&0\\-1&2&1&0\\1&1&0&1\end{bmatrix},
    \matb=\begin{bmatrix}1&0&1&0\\-1&2&0&1\\1&0&4&1\\-1&-1&2&0\end{bmatrix}
\end{equation*}

利用分块矩阵求\(\mata\matb\)。
\end{problem}
\begin{proof}
    定义子矩阵如下：
    \begin{equation*}
        \mata_3=
        \begin{bmatrix}
            -1 & 2 \\1&1
        \end{bmatrix},
        \matb_1=
        \begin{bmatrix}
            1 & 0 \\-1&2
        \end{bmatrix},
        \matb_3=
        \begin{bmatrix}
            1 & 0 \\-1&-1
        \end{bmatrix},
        \matb_4=
        \begin{bmatrix}
            4 & 1 \\2&0
        \end{bmatrix}
    \end{equation*}

    则有
    \begin{align*}
        \mata\matb & =
        \begin{bmatrix}
            \mati & \mato \\\mata_3&\mati
        \end{bmatrix}
        \begin{bmatrix}
            \matb_1 & \mati \\\matb_3&\matb_4
        \end{bmatrix}                        \\&=
        \begin{bmatrix}
            \matb_1 & \mati \\\mata_3\matb_1+\matb_3&\mata_3+\matb_4
        \end{bmatrix} \\&=
        \begin{bmatrix}
            1  & 0 & 1 & 0 \\
            -1 & 2 & 0 & 1 \\
            -2 & 4 & 3 & 3 \\
            -1 & 1 & 3 & 1
        \end{bmatrix}
    \end{align*}
\end{proof}

% 附加1.1
\begin{extraprob}\label{extra-1.1}
    证明\(\row{\mata\matb}{i}=\row{\mata}{i}\matb=\sum_{k=1}^la_{ik}\row{\matb}{k}\)。
\end{extraprob}
\begin{proof}
    设\(\mata=\normmat{bmatrix}{a}{m}{l}\)，\(\matb=\normmat{bmatrix}{b}{l}{n}\)。则有
    \begin{equation*}
        \mata\matb=
        \begin{bmatrix}
            \sum_{k=1}^la_{1k}b_{k1} & \sum_{k=1}^la_{1k}b_{k2} & \cdots & \sum_{k=1}^la_{1k}b_{kn} \\
            \sum_{k=1}^la_{2k}b_{k1} & \sum_{k=1}^la_{2k}b_{k2} & \cdots & \sum_{k=1}^la_{2k}b_{kn} \\
            \vdots                   & \vdots                   & \ddots & \vdots                   \\
            \sum_{k=1}^la_{mk}b_{k1} & \sum_{k=1}^la_{mk}b_{k2} & \cdots & \sum_{k=1}^la_{mk}b_{kn}
        \end{bmatrix}
    \end{equation*}
    \begin{equation*}
        \row{\mata\matb}{i}=
        \begin{bmatrix}
            \sum_{k=1}^la_{ik}b_{k1} & \sum_{k=1}^la_{ik}b_{k2} & \cdots\sum_{k=1}^la_{ik}b_{kn}
        \end{bmatrix}
    \end{equation*}
    \begin{align*}
        \row{\mata}{i}\matb & =
        \begin{bmatrix}
            a_{i1} & a_{i2} & \cdots & a_{il}
        \end{bmatrix}\normmat{bmatrix}{b}{l}{n} \\
                            & =
        \begin{bmatrix}
            \sum_{k=1}^la_{ik}b_{k1} & \sum_{k=1}^la_{ik}b_{k2} & \cdots\sum_{k=1}^la_{ik}b_{kn}
        \end{bmatrix}
    \end{align*}
    \begin{align*}
        \sum_{k=1}^la_{ik}\row{\matb}{k} & =\sum_{k=1}^la_{ik}
        \begin{bmatrix}
            b_{k1} & b_{k2} & \cdots & b_{kn}
        \end{bmatrix}                      \\
                                         & =
        \begin{bmatrix}
            \sum_{k=1}^la_{ik}b_{k1} & \sum_{k=1}^la_{ik}b_{k2} & \cdots\sum_{k=1}^la_{ik}b_{kn}
        \end{bmatrix}
    \end{align*}

    因此有\(\row{\mata\matb}{i}=\row{\mata}{i}\matb=\sum_{k=1}^la_{ik}\row{\matb}{k}\)。
\end{proof}

% 附加1.2
\begin{extraprob}
    证明\(\mata\matb=\sum_{k=1}^l\col{\mata}{k}\row{\matb}{k}\)。
\end{extraprob}
\begin{proof}
    和附加习题\ref{extra-1.1}解法类似，定义矩阵\(\mata=\mat{a_ij}_{m\times l}\)，\(\matb=\mat{b_{ij}}_{l\times n}\)。则有
    \begin{equation*}
        \mata\matb=
        \begin{bmatrix}
            \sum_{k=1}^la_{1k}b_{k1} & \sum_{k=1}^la_{1k}b_{k2} & \cdots & \sum_{k=1}^la_{1k}b_{kn} \\
            \sum_{k=1}^la_{2k}b_{k1} & \sum_{k=1}^la_{2k}b_{k2} & \cdots & \sum_{k=1}^la_{2k}b_{kn} \\
            \vdots                   & \vdots                   & \ddots & \vdots                   \\
            \sum_{k=1}^la_{mk}b_{k1} & \sum_{k=1}^la_{mk}b_{k2} & \cdots & \sum_{k=1}^la_{mk}b_{kn}
        \end{bmatrix}
    \end{equation*}
    \begin{align*}
          & \sum_{k=1}^l\col{\mata}{k}\row{\matb}{k}        \\ =&\sum_{k=1}^l
        \mypar{
            \begin{bmatrix}
                a_{1k} \\a_{2k}\\\vdots\\a_{mk}
            \end{bmatrix}
            \begin{bmatrix}
                b_{k1} & b_{k2} & \cdots & b_{kn}
            \end{bmatrix}
        }                                                   \\
        = & \sum_{k=1}^l
        \begin{bmatrix}
            a_{1k}b_{k1} & a_{1k}b_{k2} & \cdots & a_{1k}b_{kn} \\
            a_{2k}b_{k1} & a_{2k}b_{k2} & \cdots & a_{2k}b_{kn} \\
            \vdots       & \vdots       & \ddots & \vdots       \\
            a_{mk}b_{k1} & a_{mk}b_{k2} & \cdots & a_{mk}b_{kn}
        \end{bmatrix} \\
        = &
        \begin{bmatrix}
            \sum_{k=1}^la_{1k}b_{k1} & \sum_{k=1}^la_{1k}b_{k2} & \cdots & \sum_{k=1}^la_{1k}b_{kn} \\
            \sum_{k=1}^la_{2k}b_{k1} & \sum_{k=1}^la_{2k}b_{k2} & \cdots & \sum_{k=1}^la_{2k}b_{kn} \\
            \vdots                   & \vdots                   & \ddots & \vdots                   \\
            \sum_{k=1}^la_{mk}b_{k1} & \sum_{k=1}^la_{mk}b_{k2} & \cdots & \sum_{k=1}^la_{mk}b_{kn}
        \end{bmatrix}
    \end{align*}
    因此\(\mata\matb=\sum_{k=1}^l\col{\mata}{k}\row{\matb}{k}\)。
\end{proof}

% 附加1.3
\begin{extraprob}
    设\(\mata,\matb\)是数域\(P\)上的\(n\)级矩阵，则\(\abs{\mata\matb}=\abs{\mata}\abs{\matb}\)。

    提示：使用性质\(\col{\mata\matb}{j}=\mata\col{\matb}{j}=\sum_{k=1}^lb_{kj}\col{\mata}{k}\)。
\end{extraprob}
\begin{proof}
    设矩阵\(\mata=\mat{a_{ij}}_{n\times n}\)，矩阵\(\matb=\mat{b_{ij}}_{n\times n}\)。构造\(2n\)阶方阵\(\matf\)：
    \begin{equation*}
        \matf=
        \begin{bmatrix}
            \mata & \mato \\\matd&\matb
        \end{bmatrix},\matd=\diag{\mat{-1,-1,\dots,-1}}
    \end{equation*}

    对\(\matf\)作初等列变换，设变换后的矩阵\(\matfstar\)形如：
    \begin{equation*}
        \matfstar=\begin{bmatrix}\mata&\matc\\\matd&\mato\end{bmatrix}
    \end{equation*}

    则容易发现\(\col{\matc}{j}=\sum_{k=1}^nb_{kj}\col{\mata}{k}=\col{\mata\matb}{j}\)，即\(\matc=\mata\matb\)。

    又由Laplace定理可知，\(\abs{\matf}=\abs{\mata}\abs{\matb}\)，\(\abs{\matfstar}=-\abs{\matc}\abs{\matd}=\abs{\mata\matb}\)，配合行列式性质即可得\(\abs{\mata\matb}=\abs{\mata}\abs{\matb}\)。

\end{proof}

% 附加1.4
\begin{extraprob}
    证明：
    \begin{enumerate}
        \item \(\matc\mypar{\mata+\matb}=\matc\mata+\matc\matb\)
        \item \(\mypar{\mata+\matb}\matc=\mata\matc+\matb\matc\)
        \item \(k\mypar{\mata\matb}=\mypar{k\mata}\matb=\mata\mypar{k\matb}\)
    \end{enumerate}
    其中\(k\)为数，矩阵\(\mata,\matb,\matc\)的阶数使上述各式有意义。
\end{extraprob}
\begin{proof}
    \begin{enumerate}
        \item
              {
              设\(\matc=\mat{c_{ij}}_{m\times l}\)，\(\mata=\mat{a_{ij}}_{l\times n}\)，\(\matb=\mat{b_{ij}}_{l\times n}\)。则有
              \begin{align*}
                  \entry{\matc\mypar{\mata+\matb}}{i}{j} & =\row{\matc}{i}\col{\mata+\matb}{j}                        \\
                                                         & =\sum_{k=1}^lc_{ik}\mypar{a_{kj}+b_{kj}}                   \\
                                                         & =\sum_{k=1}^lc_{ik}a_{kj}+\sum_{k=1}^lc_{ik}b_{kj}         \\
                                                         & =\row{\matc}{i}\col{\mata}{j}+\row{\matc}{i}\col{\matb}{j} \\
                                                         & =\entry{\matc\mata}{i}{j}+\entry{\matc\matb}{i}{j}
              \end{align*}
              因此\(\matc\mypar{\mata+\matb}=\matc\mata+\matc\matb\)成立。
              }

        \item
              {
              设\(\mata=\mat{a_{ij}}_{m\times l}\)，\(\matb=\mat{b_{ij}}_{m\times l}\)，\(\matc=\mat{c_{ij}}_{l\times n}\)。则有
              \begin{align*}
                  \entry{\mypar{\mata+\matb}\matc}{i}{j} & =\row{\mata+\matb}{i}\col{\matc}{j}                        \\
                                                         & =\sum_{k=1}^l\mypar{a_{ik}+b_{ik}}c_{kj}                   \\
                                                         & =\sum_{k=1}^la_{ik}c_{kj}+\sum_{k=1}^lb_{ik}c_{kj}         \\
                                                         & =\row{\mata}{i}\col{\matc}{j}+\row{\matb}{i}\col{\matc}{j} \\
                                                         & =\entry{\mata\matc}{i}{j}+\entry{\matb\matc}{i}{j}
              \end{align*}
              因此\(\mypar{\mata+\matb}\matc=\mata\matc+\matb\matc\)成立。
              }

        \item
              {
              设\(\mata=\mat{a_{ij}}_{m\times l}\)，\(\matb=\mat{b_{ij}}_{l\times n}\)。则有
              \begin{align*}
                  \entry{\mypar{k\mata}\matb}{i}{j} & =\row{k\mata}{i}\col{\matb}{j}     \\
                                                    & =\sum_{t=1}^l\mypar{ka_{it}}b_{tj} \\
                                                    & =k\sum_{t=1}^la_{it}b_{tj}         \\
                                                    & =k\row{\mata}{i}\col{\matb}{j}     \\
                                                    & =k\entry{\mata\matb}{i}{j}
              \end{align*}
              因此\(\mypar{k\mata}\matb=k\mypar{\mata\matb}\)成立。同理可得\(\mata\mypar{k\matb}=k\mypar{\mata\matb}\)成立。
              }
    \end{enumerate}
\end{proof}

% 补充1.1
\begin{suplprob}
    设\(\mata,\matb\)为\(n\)阶方阵，且\(\mata\matb=\mata+\matb\)。证明：
    \begin{enumerate}
        \item \(\mata-\mati\)可逆；
        \item \(\mata\matb=\matb\mata\)。
    \end{enumerate}
\end{suplprob}
\begin{proof}
    \begin{enumerate}
        \item
              {
              由\(\mata\matb=\mata+\matb\)可得\(\mata\matb-\mata-\matb+\mati=\mati\)，即\(\mypar{\mata-\mati}\mypar{\matb-\mati}=\mati\)。由可逆矩阵定义知\(\mata-\mati\)可逆。
              }
        \item
              {
              由可逆矩阵定义可知\(\mypar{\mata-\mati}\mypar{\matb-\mati}=\mypar{\matb-\mati}\mypar{\mata-\mati}\)。

              等式两边展开化简后即得证。
              }
    \end{enumerate}
\end{proof}

% 补充1.2
\begin{suplprob}
    设\(\mata,\matb\)为\(n\)阶方阵，\(\mata\)对称且可逆，且\(\mypar{\mata-\matb}^2=\mati\)。化简：
    \begin{equation*}
        \mypar{\mati+\inv{\mata}\matb^\top}^\top\inv{\mypar{\mati-\matb\inv{\mata}}}
    \end{equation*}
\end{suplprob}
\begin{proof}
    \begin{align*}
          & \mypar{\mati+\inv{\mata}\matb^\top}^\top\inv{\mypar{\mati-\matb\inv{\mata}}}          \\
        = & \mypar{\mati+\matb\inv{\mata}}\inv{\mypar{\mata\inv{\mata}-\matb\inv{\mata}}}         \\
        = & \mypar{\mata\inv{\mata}+\matb\inv{\mata}}\inv{\mypar{\mypar{\mata-\matb}\inv{\mata}}} \\
        = & \mypar{\mypar{\mata+\matb}\inv{\mata}}\mata\inv{\mypar{\mata-\matb}}                  \\
        = & \mypar{\mata+\matb}\mypar{\mata-\matb}
    \end{align*}
\end{proof}

\clearpage
\section{线性方程组}

\setcounter{problem}{3}
% 2.4(2)
\begin{problem}
\end{problem}
\begin{proof}

\end{proof}

% 2.5
\begin{problem}
\end{problem}
\begin{proof}

\end{proof}

% 2.6
\begin{problem}
\end{problem}
\begin{proof}

\end{proof}

% 2.7
\begin{problem}
\end{problem}
\begin{proof}

\end{proof}

% 2.8
\begin{problem}
\end{problem}
\begin{proof}

\end{proof}

\setcounter{problem}{13}
% 2.14
\begin{problem}
\end{problem}
\begin{proof}

\end{proof}

% 2.15
\begin{problem}
\end{problem}
\begin{proof}

\end{proof}

\setcounter{problem}{20}
% 2.21
\begin{problem}
\end{problem}
\begin{proof}

\end{proof}

% 2.22
\begin{problem}
\end{problem}
\begin{proof}

\end{proof}

\setcounter{problem}{25}
% 2.26(3)
\begin{problem}
\end{problem}
\begin{proof}

\end{proof}

\setcounter{problem}{27}
% 2.28(1)
\begin{problem}
\end{problem}
\begin{proof}

\end{proof}

% 2.29(1)
\begin{problem}
\end{problem}
\begin{proof}

\end{proof}

% 2.30
\begin{problem}
\end{problem}
\begin{proof}

\end{proof}

% 2.31
\begin{problem}
\end{problem}
\begin{proof}

\end{proof}

% 2.32
\begin{problem}
\end{problem}
\begin{proof}

\end{proof}

% 2.33
\begin{problem}
\end{problem}
\begin{proof}

\end{proof}

\setcounter{problem}{34}
% 2.35
\begin{problem}
\end{problem}
\begin{proof}

\end{proof}

\setcounter{problem}{36}
% 2.37
\begin{problem}
\end{problem}
\begin{proof}

\end{proof}

\setcounter{problem}{39}
% 2.40(1)
\begin{problem}
\end{problem}
\begin{proof}

\end{proof}

% 2.41
\begin{problem}
\end{problem}
\begin{proof}

\end{proof}

\setcounter{problem}{43}
% 2.44
\begin{problem}
\end{problem}
\begin{proof}

\end{proof}

\setcounter{problem}{45}
% 2.46
\begin{problem}
\end{problem}
\begin{proof}

\end{proof}

% 2.47(2)
\begin{problem}
\end{problem}
\begin{proof}

\end{proof}

\clearpage

\section{行列式}

% 3.1
\begin{problem}
\end{problem}
\begin{proof}

\end{proof}

% 3.2
\begin{problem}
\end{problem}
\begin{proof}

\end{proof}

% 3.3
\begin{problem}
\end{problem}
\begin{proof}

\end{proof}

% 3.4
\begin{problem}
\end{problem}
\begin{proof}

\end{proof}

% 3.5
\begin{problem}
\end{problem}
\begin{proof}

\end{proof}

\setcounter{problem}{6}
% 3.7
\begin{problem}
\end{problem}
\begin{proof}

\end{proof}

\setcounter{problem}{8}
% 3.9
\begin{problem}
\end{problem}
\begin{proof}

\end{proof}

\setcounter{problem}{11}
% 3.12
\begin{problem}
\end{problem}
\begin{proof}

\end{proof}

% 3.13
\begin{problem}
\end{problem}
\begin{proof}

\end{proof}

% 3.14
\begin{problem}
\end{problem}
\begin{proof}

\end{proof}

\setcounter{problem}{15}
% 3.16
\begin{problem}
\end{problem}
\begin{proof}

\end{proof}

% 3.17
\begin{problem}
\end{problem}
\begin{proof}

\end{proof}

\setcounter{problem}{20}
% 3.21
\begin{problem}
\end{problem}
\begin{proof}

\end{proof}

\setcounter{problem}{22}
% 3.23
\begin{problem}
\end{problem}
\begin{proof}

\end{proof}

\setcounter{problem}{26}
% 3.27
\begin{problem}
\end{problem}
\begin{proof}

\end{proof}

\clearpage

\section{线性空间与线性变换}

% 4.1
\begin{problem}
在次数不大于\(2\)的多项式线性空间\(P_2[x]\)中，试证：\(\vecf_1=1\)，\(\vecf_2=x-1\)，\(\vecf_3=\mypar{x-2}\mypar{x-1}\)线性无关。
\end{problem}
\begin{proof}
    由例4.2.2可知，\(\vecveps_1=1\)，\(\vecveps_2=x\)，\(\vecveps_3=x^2\)是\(P_2[x]\)的一组基。又因为
    \begin{align*}
        \begin{bmatrix}
            \vecf_1 & \vecf_2 & \vecf_3
        \end{bmatrix}
         & =
        \begin{bmatrix}
            \vecveps_1 & \vecveps_2 & \vecveps_3
        \end{bmatrix}
        \begin{bmatrix}
            1 & -1 & 2  \\
            0 & 1  & -3 \\
            0 & 0  & 1
        \end{bmatrix} \\
         & =
        \begin{bmatrix}
            \vecveps_1 & \vecveps_2 & \vecveps_3
        \end{bmatrix}\mata
    \end{align*}
    其中\(\rank{\mata}=3\)。由例4.2.4可知\(\vecf_1,\vecf_2,\vecf_3\)线性无关。
\end{proof}

% 4.2
\begin{problem}
证明：以下三个多项式为\(P_2[x]\)的一组基：
\begin{equation*}
    f_1=1,f_2=x-1,f_3=\mypar{x-1}^2
\end{equation*}
再求\(g\mypar{x}=5x^2+x+3\)在此基下的坐标。
\end{problem}
\begin{proof}
    和习题4.1类似，令\(\vecveps_1=1\)，\(\vecveps_2=x\)，\(\vecveps_3=x^2\)表示\(P_2[x]\)的一组基。则有
    \begin{align*}
        \begin{bmatrix}
            \vecf_1 & \vecf_2 & \vecf_3
        \end{bmatrix}
         & =
        \begin{bmatrix}
            \vecveps_1 & \vecveps_2 & \vecveps_3
        \end{bmatrix}
        \begin{bmatrix}
            1 & -1 & 1  \\
            0 & 1  & -2 \\
            0 & 0  & 1
        \end{bmatrix} \\
         & =
        \begin{bmatrix}
            \vecveps_1 & \vecveps_2 & \vecveps_3
        \end{bmatrix}\mata
    \end{align*}
    其中\(\rank{\mata}=3\)，因此\(\mata\)可逆，\(\vecf_1,\vecf_2,\vecf_3\)线性无关。

    对\(\forall\vecf\in P_2[x]\)，设其坐标为\(\vecx\)。则有
    \begin{equation*}
        \vecf=
        \begin{bmatrix}
            \vecveps_1 & \vecveps_2 & \vecveps_3
        \end{bmatrix}\vecx=
        \begin{bmatrix}
            \vecf_1 & \vecf_2 & \vecf_3
        \end{bmatrix}\inv{\mata}\vecx
    \end{equation*}
    因此\(P_2[x]\)中的任意向量可由\(\vecf_1,\vecf_2,\vecf_3\)线性表出。

    综上，\(\vecf_1,\vecf_2,\vecf_3\)为\(P_2[x]\)的一组基。
\end{proof}

% 4.3
\begin{problem}
在次数不大于\(3\)的多项式空间\(P_3[x]\)中，
\begin{enumerate}
    \item 求由基\(1,x,x^2,x^3\)到基\(1,1+x,\mypar{1+x}^2,\mypar{1+x}^3\)的过渡矩阵；
    \item 求\(f\mypar{x}=a_0+a_1x+a_2x^2+a_3x^3\)在基\(1,1+x,\mypar{1+x}^2,\mypar{1+x}^3\)下的坐标。
\end{enumerate}
\end{problem}
\begin{proof}
    \begin{enumerate}
        \item {
              容易发现
              \begin{equation*}
                  \begin{bmatrix}
                      1 & 1+x & \mypar{1+x}^2 & \mypar{1+x}^3
                  \end{bmatrix}=
                  \begin{bmatrix}
                      1 & x & x^2 & x^3
                  \end{bmatrix}
                  \begin{bmatrix}
                      1 & 1 & 1 & 1 \\
                      0 & 1 & 2 & 3 \\
                      0 & 0 & 1 & 3 \\
                      0 & 0 & 0 & 1
                  \end{bmatrix}
              \end{equation*}
              因此过渡矩阵为\(\matm=
              \begin{bmatrix}
                  1 & 1 & 1 & 1 \\
                  0 & 1 & 2 & 3 \\
                  0 & 0 & 1 & 3 \\
                  0 & 0 & 0 & 1
              \end{bmatrix}\)；
              }
        \item {
              令\(\veca=\begin{bmatrix}a_0&a_1&a_2&a_3\end{bmatrix}^\top\)，则有
              \begin{align*}
                  f\mypar{x}
                   & =
                  \begin{bmatrix}
                      1 & x & x^2 & x^3
                  \end{bmatrix}\veca \\
                   & =
                  \begin{bmatrix}
                      1 & 1+x & \mypar{1+x}^2 & \mypar{1+x}^3
                  \end{bmatrix}\inv{\matm}\veca
              \end{align*}
              因此\(f\mypar{x}\)在基\(1,1+x,\mypar{1+x}^2,\mypar{1+x}^3\)下的坐标为
              \begin{equation*}
                  \inv{\matm}\veca=
                  \begin{bmatrix}
                      a_0-a_1+a_2-a_3 \\
                      a_1-2a_2+3a_3   \\
                      a_2-3a_3        \\
                      a_3
                  \end{bmatrix}
              \end{equation*}
              }
    \end{enumerate}
\end{proof}

% 4.4
\begin{problem}
在\(P_3[x]\)的多项式空间中，旧基为\(1,x,x^2,x^3\)；新基为\(1\)，\(1+x\)，\(1+x+x^2\)，\(1+x+x^2+x^3\)。
\begin{enumerate}
    \item 求旧基到新基的过渡矩阵；
    \item 求多项式\(1+2x+3x^2+4x^3\)在新基下的坐标；
    \item 若多项式\(f\mypar{x}\)在新基下的坐标为\(\mat{1,2,3,4}^\top\)，求它在旧基下的坐标。
\end{enumerate}
\end{problem}
\begin{proof}
    \begin{enumerate}
        \item 过渡矩阵为\(\matm=\begin{bmatrix}1&1&1&1\\0&1&1&1\\0&0&1&1\\0&0&0&1\end{bmatrix}\)；
        \item 因为该多项式在旧基下的坐标为\(\vecx=\begin{bmatrix}1&2&3&4\end{bmatrix}^\top\)，因此该多项式在新基下的坐标为\(\inv{\matm}\vecx=\begin{bmatrix}-1&-1&-1&4\end{bmatrix}^\top\)；
        \item 同理可得该多项式在旧基下的坐标为\(\matm\vecx=\begin{bmatrix}10&9&7&4\end{bmatrix}^\top\)。
    \end{enumerate}
\end{proof}

% 4.5
\begin{problem}
已知\(\vecxi\)在基\(\matb_1=\setof{\vecal_1,\vecal_2,\vecal_3}\)下的坐标为\(\vecxi_{\matb_1}=\mat{1,-2,2}^\top\)，求\(\vecxi\)在基\(\matb_2=\setof{\vecbeta_1,\vecbeta_2,\vecbeta_3}\)下的坐标\(\vecxi_{\matb_2}\)，其中\(\vecbeta_1=\vecal_1+\vecal_2\)，\(\vecbeta_2=\vecal_2+\vecal_3\)，\(\vecbeta_3=\vecal_3+\vecal_1\)。
\end{problem}
\begin{proof}
    由题设可知
    \begin{equation*}
        \begin{bmatrix}\vecbeta_1&\vecbeta_2&\vecbeta_3\end{bmatrix}=
        \begin{bmatrix}\vecal_1&\vecal_2&\vecal_3\end{bmatrix}
        \begin{bmatrix}
            1 & 0 & 1 \\
            1 & 1 & 0 \\
            0 & 1 & 1
        \end{bmatrix}
    \end{equation*}
    因此从基\(\matb_1\)到基\(\matb_2\)的过渡矩阵为\(\matm=\begin{bmatrix}1&0&1\\1&1&0\\0&1&1\end{bmatrix}\)。
    因此有
    \begin{equation*}
        \vecxi_{\matb_2}=\inv{\matm}\vecxi_{\matb_1}=\begin{bmatrix}-1.5&-0.5&2.5\end{bmatrix}^\top
    \end{equation*}
\end{proof}

% 4.6
\begin{problem}
设\(\vecveps_1,\vecveps_2,\vecveps_3\)是线性空间\(V\)的一组基，且
\begin{equation*}
    \begin{cases}
        \vecxi_1=\vecveps_1+\vecveps_3 \\
        \vecxi_2=\vecveps_2            \\
        \vecxi_3=\vecveps_1+2\vecveps_2+2\vecveps_3
    \end{cases}
\end{equation*}
\begin{equation*}
    \begin{cases}
        \veceta_1=\vecveps_1            \\
        \veceta_2=\vecveps_1+\vecveps_2 \\
        \veceta_3=\vecveps_1+\vecveps_2+\vecveps_3
    \end{cases}
\end{equation*}
\begin{enumerate}
    \item 试证\(\vecxi_1,\vecxi_2,\vecxi_3\)及\(\veceta_1,\veceta_2,\veceta_3\)都是\(V\)的一组基；
    \item 求由基\(\vecxi_1,\vecxi_2,\vecxi_3\)到基\(\veceta_1,\veceta_2,\veceta_3\)的过渡矩阵。
\end{enumerate}
\end{problem}
\begin{proof}
    \begin{enumerate}
        \item {
              容易发现
              \begin{align*}
                  \begin{bmatrix}\vecxi_1&\vecxi_2&\vecxi_3\end{bmatrix}
                   & =
                  \begin{bmatrix}\vecveps_1&\vecveps_2&\vecveps_3\end{bmatrix}
                  \begin{bmatrix}
                      1 & 0 & 1 \\
                      0 & 1 & 2 \\
                      1 & 0 & 2
                  \end{bmatrix}                                                        \\
                   & =\begin{bmatrix}\vecveps_1&\vecveps_2&\vecveps_3\end{bmatrix}\mata
              \end{align*}
              \begin{align*}
                  \begin{bmatrix}\veceta_1&\veceta_2&\veceta_3\end{bmatrix}
                   & =
                  \begin{bmatrix}\vecveps_1&\vecveps_2&\vecveps_3\end{bmatrix}
                  \begin{bmatrix}
                      1 & 1 & 1 \\
                      0 & 1 & 1 \\
                      0 & 0 & 1
                  \end{bmatrix}                                                        \\
                   & =\begin{bmatrix}\vecveps_1&\vecveps_2&\vecveps_3\end{bmatrix}\matb
              \end{align*}
              又因为\(\rank{\mata}=\rank{\matb}=3\)，由习题4.2可知\(\vecxi_1,\vecxi_2,\vecxi_3\)和\(\veceta_1,\veceta_2,\veceta_3\)均线性无关，且任意\(V\)中的向量均可由上述两个向量组线性表出。所以\(\vecxi_1,\vecxi_2,\vecxi_3\)和\(\veceta_1,\veceta_2,\veceta_3\)都是\(V\)的一组基；
              }
        \item {
              由(1)可得
              \begin{align*}
                  \begin{bmatrix}\veceta_1&\veceta_2&\veceta_3\end{bmatrix}
                   & =
                  \begin{bmatrix}\vecveps_1&\vecveps_2&\vecveps_3\end{bmatrix}\matb          \\
                   & =\begin{bmatrix}\vecxi_1&\vecxi_2&\vecxi_3\end{bmatrix}\inv{\mata}\matb
              \end{align*}
              因此由基\(\vecxi_1,\vecxi_2,\vecxi_3\)到基\(\veceta_1,\veceta_2,\veceta_3\)的过渡矩阵为
              \begin{equation*}
                  \inv{\mata}\matb=
                  \begin{bmatrix}
                      2  & 2  & 1 \\
                      2  & 3  & 1 \\
                      -1 & -1 & 0
                  \end{bmatrix}
              \end{equation*}
              }
    \end{enumerate}
\end{proof}

% 4.7
\begin{problem}
在线性空间\(\rea^{2\times2}\)中，已知
\begin{equation*}
    \vecal_1=\begin{bmatrix}1&0\\0&0\end{bmatrix},
    \vecal_2=\begin{bmatrix}0&1\\0&0\end{bmatrix},
    \vecal_3=\begin{bmatrix}0&0\\1&0\end{bmatrix},
    \vecal_4=\begin{bmatrix}0&0\\0&1\end{bmatrix}
\end{equation*}
为其一组基，若\(\rea^{2\times2}\)的另一组基为\(\vecbeta_1,\vecbeta_2,\vecbeta_3,\vecbeta_4\)，由\(\vecal_1,\vecal_2,\vecal_3,\vecal_4\)到\(\vecbeta_1,\vecbeta_2,\vecbeta_3,\vecbeta_4\)的过渡矩阵为
\begin{equation*}
    \mata=
    \begin{bmatrix}
        0 & 1 & 1 & 1 \\
        1 & 0 & 1 & 1 \\
        1 & 1 & 0 & 1 \\
        1 & 1 & 1 & 0
    \end{bmatrix}
\end{equation*}
求：
\begin{enumerate}
    \item 基\(\vecbeta_1,\vecbeta_2,\vecbeta_3,\vecbeta_4\)；
    \item 矩阵\begin{equation*}\begin{bmatrix}0&1\\2&-3\end{bmatrix}\end{equation*}在基\(\vecbeta_1,\vecbeta_2,\vecbeta_3,\vecbeta_4\)下的坐标。
\end{enumerate}
\end{problem}
\begin{proof}
    \begin{enumerate}
        \item {
              由题设可知
              \begin{align*}
                  \vecbeta_1 & =\vecal_2+\vecal_3+\vecal_4=\begin{bmatrix}0&1\\1&1\end{bmatrix},
                  \vecbeta_2=\vecal_1+\vecal_3+\vecal_4=\begin{bmatrix}1&0\\1&1\end{bmatrix}     \\
                  \vecbeta_3 & =\vecal_1+\vecal_2+\vecal_4=\begin{bmatrix}1&1\\0&1\end{bmatrix},
                  \vecbeta_4=\vecal_1+\vecal_2+\vecal_3=\begin{bmatrix}1&1\\1&0\end{bmatrix}
              \end{align*}
              }
        \item {
              容易得到该矩阵在基\(\vecal_1,\vecal_2,\vecal_3,\vecal_4\)下的坐标为\(\begin{bmatrix}0&1&2&-3\end{bmatrix}^\top\)。因此该矩阵在基\(\vecbeta_1,\vecbeta_2,\vecbeta_3,\vecbeta_4\)下的坐标为
              \begin{equation*}
                  \inv{\mata}\begin{bmatrix}0&1&2&-3\end{bmatrix}^\top=\begin{bmatrix}0&-1&-2&3\end{bmatrix}^\top
              \end{equation*}
              }
    \end{enumerate}
\end{proof}

% 4.8
\begin{problem}
已知实数域\(\rea\)上的所有\(2\)阶矩阵，对于矩阵的加法和数乘，构成\(\rea\)上的四维线性空间，记作\(V=\rea^{2\times2}\)。
\begin{enumerate}
    \item {
          分别证明
          \begin{equation*}
              \vecal_1=\begin{bmatrix}1&0\\0&0\end{bmatrix},
              \vecal_2=\begin{bmatrix}1&1\\0&0\end{bmatrix},
              \vecal_3=\begin{bmatrix}1&1\\1&0\end{bmatrix},
              \vecal_4=\begin{bmatrix}1&1\\1&1\end{bmatrix}
          \end{equation*}
          与
          \begin{equation*}
              \vecbeta_1=\begin{bmatrix}-1&1\\1&1\end{bmatrix},
              \vecbeta_2=\begin{bmatrix}1&-1\\1&1\end{bmatrix},
              \vecbeta_3=\begin{bmatrix}1&1\\-1&1\end{bmatrix},
              \vecbeta_4=\begin{bmatrix}1&1\\1&-1\end{bmatrix}
          \end{equation*}
          均为\(\rea^{2\times2}\)的基；}
    \item 对于\(\rea^{2\times2}\)中的任意元素\(\vecal\)，求\(\vecal\)在基\(\vecal_1,\vecal_2,\vecal_3,\vecal_4\)下的坐标；
    \item 求由基\(\vecal_1,\vecal_2,\vecal_3,\vecal_4\)到\(\vecbeta_1,\vecbeta_2,\vecbeta_3,\vecbeta_4\)的过渡矩阵。
\end{enumerate}
\end{problem}
\begin{proof}
    \begin{enumerate}
        \item {
              由习题4.7可知，
              \begin{equation*}
                  \vecveps_1=\begin{bmatrix}1&0\\0&0\end{bmatrix},
                  \vecveps_2=\begin{bmatrix}0&1\\0&0\end{bmatrix},
                  \vecveps_3=\begin{bmatrix}0&0\\1&0\end{bmatrix},
                  \vecveps_4=\begin{bmatrix}0&0\\0&1\end{bmatrix}
              \end{equation*}
              为\(\rea^{2\times2}\)的一组基。又因为
              \begin{align*}
                  \begin{bmatrix}\vecal_1&\vecal_2&\vecal_3&\vecal_4\end{bmatrix}
                   & =
                  \begin{bmatrix}\vecveps_1&\vecveps_2&\vecveps_3&\vecveps_4\end{bmatrix}
                  \begin{bmatrix}
                      1 & 1 & 1 & 1 \\
                      0 & 1 & 1 & 1 \\
                      0 & 0 & 1 & 1 \\
                      0 & 0 & 0 & 1
                  \end{bmatrix} \\
                   & =
                  \begin{bmatrix}\vecveps_1&\vecveps_2&\vecveps_3&\vecveps_4\end{bmatrix}\mata
              \end{align*}
              \begin{align*}
                  \begin{bmatrix}\vecbeta_1&\vecbeta_2&\vecbeta_3&\vecbeta_4\end{bmatrix}
                   & =
                  \begin{bmatrix}\vecveps_1&\vecveps_2&\vecveps_3&\vecveps_4\end{bmatrix}
                  \begin{bmatrix}
                      -1 & 1  & 1  & 1  \\
                      1  & -1 & 1  & 1  \\
                      1  & 1  & -1 & 1  \\
                      1  & 1  & 1  & -1
                  \end{bmatrix}                                                                \\
                   & =\begin{bmatrix}\vecveps_1&\vecveps_2&\vecveps_3&\vecveps_4\end{bmatrix}\matb
              \end{align*}
              其中\(\rank{\mata}=\rank{\matb}=4\)，所以\(\vecal_1,\vecal_2,\vecal_3,\vecal_4\)和\(\vecbeta_1,\vecbeta_2,\vecbeta_3,\vecbeta_4\)均为\(\rea^{2\times2}\)的基；
              }
        \item {
              设\(\vecal=\begin{bmatrix}\alpha_{11}&\alpha_{12}\\\alpha_{21}&\alpha_{22}\end{bmatrix}\)，则\(\vecal\)在基\(\vecveps_1,\vecveps_2,\vecveps_3,\vecveps_4\)下的坐标为\(\begin{bmatrix}\alpha_{11}&\alpha_{12}&\alpha_{21}&\alpha_{22}\end{bmatrix}^\top\)。由(1)可得\(\vecal\)在基\(\vecal_1,\vecal_2,\vecal_3,\vecal_4\)下的坐标为
              \begin{equation*}
                  \inv{\mata}\begin{bmatrix}\alpha_{11}\\\alpha_{12}\\\alpha_{21}\\\alpha_{22}\end{bmatrix}=
                  \begin{bmatrix}\alpha_{11}-\alpha_{12}\\\alpha_{12}-\alpha_{21}\\\alpha_{21}-\alpha_{22}\\\alpha_{22}\end{bmatrix}
              \end{equation*}
              }
        \item {
              由(1)可得
              \begin{align*}
                  \begin{bmatrix}\vecbeta_1&\vecbeta_2&\vecbeta_3&\vecbeta_4\end{bmatrix}
                   & =\begin{bmatrix}\vecveps_1&\vecveps_2&\vecveps_3&\vecveps_4\end{bmatrix}\matb    \\
                   & =\begin{bmatrix}\vecal_1&\vecal_2&\vecal_3&\vecal_4\end{bmatrix}\inv{\mata}\matb
              \end{align*}
              所以由基\(\vecal_1,\vecal_2,\vecal_3,\vecal_4\)到\(\vecbeta_1,\vecbeta_2,\vecbeta_3,\vecbeta_4\)的过渡矩阵为
              \begin{equation*}
                  \inv{\mata}\matb=
                  \begin{bmatrix}
                      -2 & 2  & 0  & 0  \\
                      0  & -2 & 2  & 0  \\
                      0  & 0  & -2 & 2  \\
                      1  & 1  & 1  & -1
                  \end{bmatrix}
              \end{equation*}
              }
    \end{enumerate}
\end{proof}

% 4.9
\begin{problem}
求下列两个齐次线性方程组的解空间的基和维数：
\begin{enumerate}
    \item \(x_1+x_2+\cdots+x_n=0\)；
    \item \begin{equation*}
              \begin{cases}
                  2x_1-4x_2+5x_3+3x_4=0 \\
                  3x_1-6x_2+4x_3+2x_4=0 \\
                  4x_1-8x_2+17x_3+11x_4=0
              \end{cases}
          \end{equation*}
\end{enumerate}
\end{problem}
\begin{proof}
    \begin{enumerate}
        \item {
              方程组对应的系数矩阵的最简阶梯型矩阵为\(\begin{bmatrix}1&1&\cdots&1\end{bmatrix}\)，因此解空间的基为
              \begin{equation*}
                  \begin{bmatrix}-1\\1\\0\\0\\\vdots\\0\\0\end{bmatrix},
                  \begin{bmatrix}-1\\0\\1\\0\\\vdots\\0\\0\end{bmatrix},\cdots
                  \begin{bmatrix}-1\\0\\0\\0\\\vdots\\0\\1\end{bmatrix}
              \end{equation*}
              维数为\(n-1\)；
              }
        \item {
              方程组对应的系数矩阵的最简阶梯型矩阵为
              \begin{equation*}
                  \begin{bmatrix}
                      1 & -2 & 0 & -\frac{2}{7} \\
                      0 & 0  & 1 & \frac{5}{7}  \\
                      0 & 0  & 0 & 0
                  \end{bmatrix}
              \end{equation*}
              因此解空间的基为\(\begin{bmatrix}2&1&0&0\end{bmatrix}^\top\)，\(\begin{bmatrix}2&0&-5&7\end{bmatrix}^\top\)，维数为\(2\)。
              }
    \end{enumerate}
\end{proof}

% 4.10
\begin{problem}
设\(\enums{\vecal}{n}\)是\(n\)维线性空间\(V\)的一组基，又\(V\)中向量\(\vecal_{n+1}\)在这组基下坐标\(\mypar{\enums{x}{n}}\)全都不为零。

证明\(\enums{\vecal}{n},\vecal_{n+1}\)中任意\(n\)个向量必构成\(V\)的一组基，并求\(\vecal_1\)在基\(\vecal_2,\dots,\vecal_n,\vecal_{n+1}\)下的坐标。
\end{problem}
\begin{proof}
    因为\(\enums{\vecal}{n}\)是\(V\)的一组基，下面证明对\(\forall i=1,2,\dots,n\)，
    \begin{equation*}
        \mata_i=\setof{\vecal_1,\dots,\vecal_{i-1},\vecal_{i+1},\dots,\vecal_{n+1}}
    \end{equation*}
    都是\(V\)的一组基。

    由题设可知
    \begin{align*}
        \begin{bmatrix}\vecal_1\\\vdots\\\vecal_{i+1}\\\vdots\\\vecal_{n+1}\end{bmatrix}^\top
         & =
        \begin{bmatrix}\vecal_1\\\vecal_2\\\vdots\\\vecal_n\end{bmatrix}^\top
        \begin{bmatrix}
            1      & \cdots & 0      & 0      & \cdots & 0      & x_1     \\
            \vdots & \ddots & \vdots & \vdots & \cdots & \vdots & \vdots  \\
            0      & \cdots & 1      & 0      & \cdots & 0      & x_{i-1} \\
            0      & \cdots & 0      & 0      & \cdots & 0      & x_i     \\
            0      & \cdots & 0      & 1      & \cdots & 0      & x_{i+1} \\
            \vdots &        & \vdots & \vdots & \ddots & \vdots & \vdots  \\
            0      & \cdots & 0      & 0      & \cdots & 1      & x_n
        \end{bmatrix} \\
         & =
        \begin{bmatrix}\vecal_1\\\vecal_2\\\vdots\\\vecal_n\end{bmatrix}^\top\matm_i
    \end{align*}
    容易发现\(\rank{\matm}=n\)，所以\(\mata_i\)线性无关，且\(V\)中任意向量可由\(\mata_i\)线性表出。

    因此\(\enums{\vecal}{n},\vecal_{n+1}\)中任意\(n\)个向量必构成\(V\)的一组基。

    同时，由等式\(\vecal_{n+1}=x_1\vecal_1+x_2\vecal_2+\cdots+x_n\vecal_n\)可得
    \begin{equation*}
        \vecal_1=-\frac{x_2}{x_1}\vecal_2-\cdots-\frac{x_n}{x_1}\vecal_n+\frac{1}{x_1}\vecal_{n+1}
    \end{equation*}
    所以\(\vecal_1\)在在基\(\vecal_2,\dots,\vecal_n,\vecal_{n+1}\)下的坐标为\(\begin{bmatrix}-\frac{x_2}{x_1}&\cdots&-\frac{x_n}{x_1}&\frac{1}{x_1}\end{bmatrix}^\top\)。

\end{proof}

\setcounter{problem}{11}
% 4.12
\begin{problem}
设\(V_1,V_2\)是\(\rea^n\)的两个非平凡子空间，证明：在\(\rea^n\)中存在向量\(\vecal\)，使\(\vecal\notin V_1\)，且\(\vecal\notin V_2\)，并在\(\rea^3\)中举例说明此结论。
\end{problem}
\begin{proof}
    \begin{enumerate}
        \item {
              若\(V_1,V_2\)其中一个是另一个的子空间，则不妨设\(V_1\subseteq V_2\)。

              因为\(V_2\)非平凡，存在\(\vecal\in\rea^n\)满足\(\vecal\notin V_2\)，从而\(\vecal\notin V_1\)；
              }
        \item {
              若\(V_1,V_2\)中任意空间都不是另一个的子空间，则存在\(\vecal_1\in V_1\cap\overline{V_2}\)，\(\vecal_2\in V_2\cap\overline{V_1}\)。此时构造\(\vecal=\vecal_1+\vecal_2\)。

              若\(\vecal\in V_1\)，则有\(\vecal_2=\vecal-\vecal_1\in V_1\)，与假设矛盾。因此\(\vecal\notin V_1\)。同理可得\(\vecal\notin V_2\)，结论得证。

              举例：\(V_1=\myspan{\mat{1,0,0}^\top,\mat{0,1,0}^\top}\)，\(V_2=\myspan{\mat{0,1,0}^\top,\mat{0,0,1}^\top}\)，\(\vecal=\mat{1,0,1}^\top\)。
              }
    \end{enumerate}
\end{proof}

% 4.13
\begin{problem}
设\(\vecal,\vecbeta,\vecgamma\in\rea^n\)，\(c_1,c_2,c_3\in\rea\)，且\(c_1c_3\neq0\)，证明：若\(c_1\vecal+c_2\vecbeta+c_3\vecgamma=\veczero\)，则\(\myspan{\vecal,\vecbeta}=\myspan{\vecbeta,\vecgamma}\)。
\end{problem}
\begin{proof}
    因为\(c_1\vecal+c_2\vecbeta+c_3\vecgamma=\veczero\)，且\(c_1c_3\neq0\)，所以有\(\vecal=-\frac{c_2}{c_1}\vecbeta-\frac{c_3}{c_1}\vecgamma\)。

    因此对\(\forall\veceta\in\myspan{\vecal,\vecbeta}\)，不妨设\(\veceta=\lambda_1\vecal+\lambda_2\vecbeta\)，则有
    \begin{align*}
        \veceta & =\lambda_1\mypar{-\frac{c_2}{c_1}\vecbeta-\frac{c_3}{c_1}\vecgamma}+\lambda_2\vecbeta \\
                & =\mypar{\lambda_2-\frac{c_2\lambda_1}{c_1}}\vecbeta-\frac{c_3\lambda_1}{c_1}\vecgamma
    \end{align*}
    所以\(\veceta\in\myspan{\vecbeta,\vecgamma}\)，即\(\myspan{\vecal,\vecbeta}\subseteq\myspan{\vecbeta,\vecgamma}\)。

    同理可得\(\myspan{\vecbeta,\vecgamma}\subseteq\myspan{\vecal,\vecbeta}\)。因此\(\myspan{\vecal,\vecbeta}=\myspan{\vecbeta,\vecgamma}\)。
\end{proof}

% 4.14
\begin{problem}
若
\begin{equation*}
    \mata=\begin{bmatrix}1&1&1&0\\2&1&0&1\end{bmatrix}
\end{equation*}
求\(\mata\)的零空间\(\nullsp{\mata}\)的一组基。
\end{problem}
\begin{proof}
    对\(A\)使用初等变换，将其化为最简阶梯型矩阵：
    \begin{equation*}
        \begin{bmatrix}
            1 & 0 & -1 & 1  \\
            0 & 1 & 2  & -1
        \end{bmatrix}
    \end{equation*}
    因此得到\(\nullsp{\mata}\)的一组基为\(\mat{1,-2,1,0}^\top\)，\(\mat{-1,1,0,1}^\top\)。
\end{proof}

\setcounter{problem}{15}
% 4.16
\begin{problem}
已知向量组\(\vecal_1=\mat{2,0,1,3,-1}^\top\)，\(\vecal_2=\mat{0,-2,1,5,-3}^\top\)，\(\vecbeta_1=\mat{1,1,0,-1,1}^\top\)，\(\vecbeta_2=\mat{1,-3,2,0,5}^\top\)，且\(W_1=\myspan{\vecal_1,\vecal_2}\)，\(W_2=\myspan{\vecbeta_1,\vecbeta_2}\)。试求\(W_1\cap W_2\)与\(W_1+W_2\)的维数以及各自的一组基。
\end{problem}
\begin{proof}
    因为\(W_1+W_2=\myspan{\vecal_1,\vecal_2,\vecbeta_1,\vecbeta_2}\)，因此考虑对\(\mat{\vecal_1,\vecal_2,\vecbeta_1,\vecbeta_2}\)作初等行变换，化为最简阶梯型矩阵：
    \begin{equation*}
        \begin{bmatrix}
            2  & 0  & 1  & 1  \\
            0  & -2 & 1  & -3 \\
            1  & 1  & 0  & 2  \\
            3  & 5  & -1 & 0  \\
            -1 & -3 & 1  & 5
        \end{bmatrix}\Rightarrow
        \begin{bmatrix}
            1 & 0 & \frac{1}{2}  & 0 \\
            0 & 1 & -\frac{1}{2} & 0 \\
            0 & 0 & 0            & 1 \\
            0 & 0 & 0            & 0 \\
            0 & 0 & 0            & 0
        \end{bmatrix}
    \end{equation*}
    所以\(W_1+W_2\)的维数为\(3\)，一组基为\(\vecal_1,\vecal_2,\vecbeta_2\)。

    由维数公式可知\(W_1\cap W_2\)的维数为\(1\)，又因为\(\vecbeta_1=\frac{1}{2}\vecal_1-\frac{1}{2}\vecal_2\in W_1\)，所以\(\vecbeta_1\in W_1\cap W_2\)为其一组基。
\end{proof}

% 4.17
\begin{problem}
设\(V\)是内积空间，试证明：
\begin{enumerate}
    \item 对\(\forall\vecal\in V\)，都有\(\indot{\veczero}{\vecal}=0\)；
    \item 若对\(\forall\vecal\in V\)，恒有\(\indot{\vecal}{\vecbeta}=0\)，则\(\vecbeta=\veczero\)；
    \item 已知\(\vecal,\vecbeta\in V\)，如对\(\forall\vecgamma\in V\)，都有\(\indot{\vecal}{\vecgamma}=\indot{\vecbeta}{\vecgamma}\)。试证明\(\vecal=\vecbeta\)。
\end{enumerate}
\end{problem}
\begin{proof}
    \begin{enumerate}
        \item {
              对\(\forall\vecbeta\in V\)，有
              \begin{equation*}
                  \indot{\veczero}{\vecal}=\indot{\vecbeta+\mypar{-\vecbeta}}{\vecal}=\indot{\vecbeta}{\vecal}-\indot{\vecbeta}{\vecal}=0
              \end{equation*}
              }
        \item 令\(\vecal=\vecbeta\)，得到\(\indot{\vecbeta}{\vecbeta}=0\)，由内积定义知\(\vecbeta=\veczero\)；
        \item 由\(\indot{\vecal}{\vecgamma}=\indot{\vecbeta}{\vecgamma}\)可得\(\indot{\vecal-\vecbeta}{\vecgamma}=0\)。由\(\vecgamma\)的任意性及(2)结论可知\(\vecal-\vecbeta=\veczero\)，即\(\vecal=\vecbeta\)。
    \end{enumerate}
\end{proof}

\setcounter{problem}{19}
% 4.20
\begin{problem}
设\(\enums{\vecal}{n}\)是内积空间的\(n\)个向量，行列式
\begin{equation*}
    \gram{\enums{\vecal}{n}}=
    \begin{vmatrix}
        \indot{\vecal_1}{\vecal_1} & \indot{\vecal_1}{\vecal_2} & \cdots & \indot{\vecal_1}{\vecal_n} \\
        \indot{\vecal_2}{\vecal_1} & \indot{\vecal_2}{\vecal_2} & \cdots & \indot{\vecal_2}{\vecal_n} \\
        \vdots                     & \vdots                     &        & \vdots                     \\
        \indot{\vecal_n}{\vecal_1} & \indot{\vecal_n}{\vecal_2} & \cdots & \indot{\vecal_n}{\vecal_n}
    \end{vmatrix}
\end{equation*}
称为\(\enums{\vecal}{n}\)的Gram行列式。证明\(\gram{\enums{\vecal}{n}}=0\)的充分必要条件是\(\enums{\vecal}{n}\)线性相关。
\end{problem}
\begin{proof}
    \begin{itemize}
        \item {
              首先证明充分性。

              若\(\enums{\vecal}{n}\)线性相关，则有\(\sum_{i=1}^nk_i\vecal_i=\veczero\)，其中\(k_i\)不全为零。
              因此对\(\forall j=1,2,\dots,n\)，有
              \begin{equation*}
                  \indot{\vecal_j}{\sum_{i=1}^nk_i\vecal_i}=\sum_{i=1}^nk_i\indot{\vecal_j}{\vecal_i}=0
              \end{equation*}
              所以\(\gram{\enums{\vecal}{n}}\)对应矩阵的列线性相关，进一步得到
              \begin{equation*}
                  \gram{\enums{\vecal}{n}}=0
              \end{equation*}
              }
        \item {
              随后证明必要性。
              若\(\gram{\enums{\vecal}{n}}=0\)，则其对应矩阵的列线性相关。因此对\(\forall j=1,2,\dots,n\)，有\(\sum_{i=1}^nk_i\indot{\vecal_j}{\vecal_i}=0\)，其中\(k_i\)不全为零，从而进一步得到\(\indot{\vecal_j}{\sum_{i=1}^nk_i\vecal_i}=0\)。由内积性质得到
              \begin{equation*}
                  \indot{\sum_{i=1}^nk_i\vecal_i}{\sum_{i=1}^nk_i\vecal_i}=0
              \end{equation*}
              因此\(\sum_{i=1}^nk_i\vecal_i=\veczero\)，\(\enums{\vecal}{n}\)线性相关。
              }
    \end{itemize}
\end{proof}

% 4.21
\begin{problem}
设\(\enums{\vecal}{r}\)线性无关，\(\vecbeta_1,\vecbeta_2\)也线性无关，且后者与前者中的每个向量都正交，证明：\(\vecbeta_1,\vecbeta_2,\enums{\vecal}{r}\)也线性相关。
\end{problem}
\begin{proof}

\end{proof}

% 4.22
\begin{problem}
试把\(\mat{1,0,1,0}^\top\)，\(\mat{0,1,0,2}^\top\)扩充成为\(\rea^4\)的一组标准正交基。
\end{problem}
\begin{proof}

\end{proof}

% 4.23
\begin{problem}
已知\(f_1=1\)，\(f_2=x-1\)，\(f_3=\mypar{x-1}^2\)为三维内积空间\(C\mat{0,1}\)的一组基，内积定义为
\begin{equation*}
    \indot{f}{g}=\int_0^1f\mypar{x}g\mypar{x}\mathrm{d}x
\end{equation*}
利用Schmidt正交化方法，求与\(f_1,f_2,f_3\)等价的一组标准正交基（两个向量组可相互线性表出称为等价）。
\end{problem}
\begin{proof}

\end{proof}

% 4.24
\begin{problem}
设\(\enums{\vecal}{n}\)与\(\enums{\vecbeta}{n}\)为\(n\)维欧氏空间的两组基，其中\(\enums{\vecal}{n}\)为标准正交基，又若由\(\enums{\vecal}{n}\)到\(\enums{\vecbeta}{n}\)的过渡矩阵为\(\matm\)，证明：\(\enums{\vecbeta}{n}\)为\(V\)的标准正交基的充分必要条件是\(\matm\)为正交矩阵。
\end{problem}
\begin{proof}

\end{proof}

\setcounter{problem}{25}
% 4.26
\begin{problem}
设
\begin{equation*}
    \mata=
    \begin{bmatrix}
        1 & 2  & -1 \\
        2 & 0  & 1  \\
        2 & -4 & 2  \\
        4 & 0  & 0
    \end{bmatrix},
    \vecb=\begin{bmatrix}-1\\1\\1\\-2\end{bmatrix}
\end{equation*}
问线性方程组\(\mata\vecx=\vecb\)是否有解？如果无解，求其最小二乘解。
\end{problem}
\begin{proof}

\end{proof}

% 4.27
\begin{problem}
求向量\(\vecb\)在矩阵\(\mata\)的列空间中的正交投影。
\begin{equation*}
    \mata=
    \begin{bmatrix}
        1 & -2 \\
        1 & 0  \\
        1 & 1  \\
        1 & 3
    \end{bmatrix},
    \vecb=\begin{bmatrix}-4\\-3\\3\\0\end{bmatrix}
\end{equation*}
\end{problem}
\begin{proof}

\end{proof}

% 4.28
\begin{problem}
设齐次线性方程组
\begin{equation*}
    \begin{cases}
        2x_1+x_2-x_3+x_4-3x_5=0 \\
        x_1+x_2-x_3+x_5=0
    \end{cases}
\end{equation*}
\begin{enumerate}
    \item 求解空间的标准正交基；
    \item 求解空间的正交补空间的标准正交基。
\end{enumerate}
\end{problem}
\begin{proof}

\end{proof}

% 4.29
\begin{problem}
设\(\vecal_1,\vecal_2\)和\(\vecal\)是Euclid空间\(\rea^3\)中的向量，
\begin{equation*}
    \vecal_1=\begin{bmatrix}1\\1\\2\end{bmatrix},
    \vecal_2=\begin{bmatrix}1\\0\\1\end{bmatrix},
    \vecal=\begin{bmatrix}3\\2\\1\end{bmatrix}
\end{equation*}
求\(\myspan{\vecal_1,\vecal_2}\)的正交补空间以及向量\(\vecal\)分别在\(\myspan{\vecal_1,\vecal_2}\)及其正交补空间中的正交投影。
\end{problem}
\begin{proof}

\end{proof}

\setcounter{problem}{30}
% 4.31
\begin{problem}
已知在\(\rea^3\)中，线性变换\(T\)在基
\begin{equation*}
    \vecveps_1=\begin{bmatrix}8\\-6\\7\end{bmatrix},
    \vecveps_2=\begin{bmatrix}-16\\7\\-13\end{bmatrix},
    \vecveps_3=\begin{bmatrix}9\\-3\\7\end{bmatrix}
\end{equation*}
下的表示矩阵
\begin{equation*}
    \mata=
    \begin{bmatrix}
        1  & -18 & 15 \\
        -1 & -22 & 20 \\
        1  & -25 & 22
    \end{bmatrix}
\end{equation*}
求\(T\)在基
\begin{equation*}
    \veceta_1=\begin{bmatrix}1\\-2\\1\end{bmatrix},
    \veceta_2=\begin{bmatrix}3\\-1\\2\end{bmatrix},
    \veceta_3=\begin{bmatrix}2\\1\\2\end{bmatrix}
\end{equation*}
下的表示矩阵。
\end{problem}
\begin{proof}

\end{proof}

\setcounter{problem}{32}
% 4.33
\begin{problem}
给定\(\rea^3\)的两组基：
\begin{equation*}
    \vecveps_1=\begin{bmatrix}1\\0\\1\end{bmatrix},
    \vecveps_2=\begin{bmatrix}2\\1\\0\end{bmatrix},
    \vecveps_3=\begin{bmatrix}1\\1\\1\end{bmatrix}
\end{equation*}
和
\begin{equation*}
    \veceta_1=\begin{bmatrix}1\\2\\-1\end{bmatrix},
    \veceta_2=\begin{bmatrix}2\\2\\-1\end{bmatrix},
    \veceta_3=\begin{bmatrix}2\\-1\\-1\end{bmatrix}
\end{equation*}
定义线性变换：\(T\mypar{\vecveps_i}=\veceta_i\)，\(i\in\setof{1,2,3}\)。分别求\(T\)在基\(\vecveps_1,\vecveps_2,\vecveps_3\)与\(\veceta_1,\veceta_2,\veceta_3\)下的表示矩阵。
\end{problem}
\begin{proof}

\end{proof}

\end{document}
